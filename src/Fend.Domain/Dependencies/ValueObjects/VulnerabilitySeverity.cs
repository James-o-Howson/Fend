using Fend.SharedKernel;
using Fend.SharedKernel.Base;

namespace Fend.Domain.Dependencies.ValueObjects;

public sealed class VulnerabilitySeverity : ValueObject
{
    public required decimal Score { get; init; }
    public required SeverityType Type { get; init; }
    
    private VulnerabilitySeverity() { }

    public static VulnerabilitySeverity Create(decimal score, SeverityType type)
    {
        if(score <= 0) throw new DomainException("Vulnerability Severity Score must be greater than 0");
        
        return new VulnerabilitySeverity
        {
            Score = score,
            Type = type
        };
    }

    protected override IEnumerable<object?> GetEqualityComponents()
    {
        yield return Score;
        yield return Type;
    }
}